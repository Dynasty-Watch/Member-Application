import {
  IonContent,
  IonHeader,
  IonPage,
  IonTitle,
  IonToolbar,
  IonButtons,
  IonMenuButton,
  IonButton,
  IonGrid,
  IonRow,
  IonCol,
  useIonViewWillEnter,
} from "@ionic/react";

import React, { useEffect, useRef, useState } from "react";
import "./Statistic.css";
import {
  GoogleMap,
  useLoadScript,
  Marker,
  Polygon,
  KmlLayer,
  HeatmapLayer
} from "@react-google-maps/api";
import { Geolocation } from "@capacitor/geolocation";
import { supabase } from "../supabaseClient";
import { Supa } from "../SupaClient";
import FusionCharts from "fusioncharts";
import Charts from "fusioncharts/fusioncharts.charts";
import FusionTheme from "fusioncharts/themes/fusioncharts.theme.fusion";
import ReactFC from "react-fusioncharts";
//import { map } from "ionicons/icons";
ReactFC.fcRoot(FusionCharts, Charts, FusionTheme);

var CityofJoburgDelimiters = [
  {location: new google.maps.LatLng(-26.19391, 28.00146), weight: 0.5}

  // { lat: -26.52170372, lng: 27.87792397 },
  // { lat: -26.52167511, lng: 27.87734032 },
  // { lat: -26.52144051, lng: 27.87562943 },
  // { lat: -26.52050018, lng: 27.87487984 },
  // { lat: -26.51989937, lng: 27.87413979 },
  // { lat: -26.51929092, lng: 27.87253952 },
  // { lat: -26.51786041, lng: 27.87204933 },
  // { lat: -26.51759911, lng: 27.87179947 },
  // { lat: -26.5175705, lng: 27.87162018 },
  // { lat: -26.51741028, lng: 27.87158012 },
  // { lat: -26.51719093, lng: 27.87129974 },
  // { lat: -26.5167408, lng: 27.86688995 },
  // { lat: -26.51280022, lng: 27.86639023 },
  // { lat: -26.51254082, lng: 27.86614037 },
  // { lat: -26.5125103, lng: 27.86606407 },
  // { lat: -26.51243973, lng: 27.86597061 },
  // { lat: -26.51235008, lng: 27.86593056 },
  // { lat: -26.51213074, lng: 27.86564064 },
  // { lat: -26.5116806, lng: 27.86458015 },
  // { lat: -26.51073074, lng: 27.86457062 },
  // { lat: -26.51050949, lng: 27.86454773 },
  // { lat: -26.50999832, lng: 27.86432076 },
  // { lat: -26.50979042, lng: 27.86046028 },
  // { lat: -26.50629044, lng: 27.86042976 },
  // { lat: -26.50625992, lng: 27.85984993 },
  // { lat: -26.50646973, lng: 27.85783005 },
  // { lat: -26.50463867, lng: 27.85776138 },
  // { lat: -26.50457764, lng: 27.85753059 },
  // { lat: -26.50436783, lng: 27.85648537 },
  // { lat: -26.50342178, lng: 27.85560036 },
  // { lat: -26.50342178, lng: 27.85560036 },
  // { lat: -26.5026207, lng: 27.8542366 },
  // { lat: -26.50138664, lng: 27.85400963 },
  // { lat: -26.50118065, lng: 27.85334969 },
  // { lat: -26.50064087, lng: 27.85292053 },
  // { lat: -26.50028992, lng: 27.85201073 },
  // { lat: -26.49972916, lng: 27.84737015 },
  // { lat: -26.49718094, lng: 27.8468914 },
  // { lat: -26.49691772, lng: 27.84682083 },
  // { lat: -26.49687958, lng: 27.84166527 },
  // { lat: -26.49405861, lng: 27.83506966 },
  // { lat: -26.49044991, lng: 27.83474922 },
  // { lat: -26.49074936, lng: 27.82996368 },
  // { lat: -26.50007629, lng: 27.8298111 },
  // { lat: -26.50037384, lng: 27.82777786 },
  // { lat: -26.5043354, lng: 27.82773018 },
  // { lat: -26.50443077, lng: 27.8276062 },
  // { lat: -26.50350189, lng: 27.82664871 },
  // { lat: -26.49627304, lng: 27.82518005 },
  // { lat: -26.48518944, lng: 27.82446861 },
  // { lat: -26.47987747, lng: 27.82168961 },
  // { lat: -26.48488045, lng: 27.81911469 },
  // { lat: -26.4845295, lng: 27.8184948 },
  // { lat: -26.48444557, lng: 27.81785011 },
  // { lat: -26.48435974, lng: 27.81658936 },
  // { lat: -26.48418999, lng: 27.81534004 },
  // { lat: -26.48402023, lng: 27.81410027 },
  // { lat: -26.48386002, lng: 27.81287956 },
  // { lat: -26.4836998, lng: 27.8116703 },
  // { lat: -26.48353004, lng: 27.80928993 },
  // { lat: -26.48320961, lng: 27.80810928 },
  // { lat: -26.48306084, lng: 27.80694962 },
  // { lat: -26.48290062, lng: 27.80588913 },
  // { lat: -26.48275948, lng: 27.80578995 },
  // { lat: -26.4827404, lng: 27.80463982 },
  // { lat: -26.48258972, lng: 27.80349922 },
  // { lat: -26.48244095, lng: 27.80295944 },
  // { lat: -26.48236084, lng: 27.78132057 },
  // { lat: -26.47945023, lng: 27.78104019 },
  // { lat: -26.47941971, lng: 27.77955055 },
  // { lat: -26.47921944, lng: 27.77953911 },
  // { lat: -26.47930145, lng: 27.77902031 },
  // { lat: -26.48366356, lng: 27.77886009 },
  // { lat: -26.48501015, lng: 27.75971031 },
  // { lat: -26.45965195, lng: 27.7592392 },
  // { lat: -26.44466019, lng: 27.76893997 },
  // { lat: -26.4456501, lng: 27.76926422 },
  // { lat: -26.45072365, lng: 27.76927948 },
  // { lat: -26.45096016, lng: 27.76980019 },
  // { lat: -26.45112991, lng: 27.76987076 },
  // { lat: -26.45107079, lng: 27.77012062 },
  // { lat: -26.45085907, lng: 27.77043915 },
  // { lat: -26.45092964, lng: 27.77059937 },
  // { lat: -26.45137024, lng: 27.77276993 },
  // { lat: -26.45195007, lng: 27.77591515 },
  // { lat: -26.45221329, lng: 27.77729988 },
  // { lat: -26.45232964, lng: 27.78027916 },
  // { lat: -26.4525795, lng: 27.78058243 },
  // { lat: -26.4520092, lng: 27.78150368 },
  // { lat: -26.45027351, lng: 27.78339958 },
  // { lat: -26.44669914, lng: 27.78594017 },
  // { lat: -26.44762039, lng: 27.78663063 },
  // { lat: -26.44611931, lng: 27.78739929 },
  // { lat: -26.44444084, lng: 27.78894043 },
  // { lat: -26.44109917, lng: 27.78970909 },
  // { lat: -26.4394207, lng: 27.79047966 },
  // { lat: -26.43774986, lng: 27.79125023 },
  // { lat: -26.43606949, lng: 27.7920208 },
  // { lat: -26.43440056, lng: 27.79307938 },
  // { lat: -26.4321003, lng: 27.79454994 },
  // { lat: -26.42888069, lng: 27.79164886 },
  // { lat: -26.42024231, lng: 27.79162979 },
  // { lat: -26.42019081, lng: 27.79009056 },
  // { lat: -26.4198494, lng: 27.7861805 },
  // { lat: -26.41897964, lng: 27.77206993 },
  // { lat: -26.41906929, lng: 27.76869011 },
  // { lat: -26.41909027, lng: 27.7612896 },
  // { lat: -26.4191494, lng: 27.75810051 },
  // { lat: -26.40205956, lng: 27.7572403 },
  // { lat: -26.39748001, lng: 27.75613976 },
  // { lat: -26.39163017, lng: 27.75485992 },
  // { lat: -26.3847599, lng: 27.75474739 },
  // { lat: -26.38414764, lng: 27.75473595 },
  // { lat: -26.3841095, lng: 27.75462914 },
  // { lat: -26.38327026, lng: 27.75403023 },
  // { lat: -26.37870979, lng: 27.75357056 },
  // { lat: -26.37511063, lng: 27.7532692 },
  // { lat: -26.37285042, lng: 27.75279999 },
  // { lat: -26.36922073, lng: 27.75186348 },
  // { lat: -26.3619957, lng: 27.75885963 },
  // { lat: -26.36228943, lng: 27.75945091 },
  // { lat: -26.36231995, lng: 27.76108932 },
  // { lat: -26.36239052, lng: 27.76268959 },
  // { lat: -26.36245918, lng: 27.76786041 },
  // { lat: -26.36268044, lng: 27.76869965 },
  // { lat: -26.36272049, lng: 27.76954079 },
  // { lat: -26.3627491, lng: 27.77038002 },
  // { lat: -26.36278915, lng: 27.77121925 },
  // { lat: -26.36281967, lng: 27.77289963 },
  // { lat: -26.36289978, lng: 27.77374077 },
  // { lat: -26.3629303, lng: 27.77458 },
  // { lat: -26.36297035, lng: 27.77541924 },
  // { lat: -26.36300087, lng: 27.77626038 },
  // { lat: -26.36304474, lng: 27.78280067 },
  // { lat: -26.36332512, lng: 27.78910065 },
  // { lat: -26.36359024, lng: 27.80283928 },
  // { lat: -26.36417007, lng: 27.80285072 },
  // { lat: -26.36411095, lng: 27.80710983 },
  // { lat: -26.36429024, lng: 27.8115406 },
  // { lat: -26.36446953, lng: 27.81159019 },
  // { lat: -26.36447525, lng: 27.81153679 },
  // { lat: -26.36297417, lng: 27.8104496 },
  // { lat: -26.33288956, lng: 27.82082939 },
  // { lat: -26.33628082, lng: 27.82447052 },
  // { lat: -26.33748055, lng: 27.82408905 },
  // { lat: -26.33288002, lng: 27.82341003 },
  // { lat: -26.3247509, lng: 27.8234005 },
  // { lat: -26.3245697, lng: 27.82338142 },
  // { lat: -26.32437134, lng: 27.82333946 },
  // { lat: -26.32386971, lng: 27.8232193 },
  // { lat: -26.3223896, lng: 27.82276917 },
  // { lat: -26.31690979, lng: 27.82274437 },
  // { lat: -26.31670189, lng: 27.82274055 },
  // { lat: -26.31666946, lng: 27.82271957 },
  // { lat: -26.31638908, lng: 27.82227325 },
  // { lat: -26.31101608, lng: 27.82226372 },
  // { lat: -26.3108902, lng: 27.8222599 },
  // { lat: -26.31085968, lng: 27.82176018 },
  // { lat: -26.30475998, lng: 27.82176018 },
  // { lat: -26.30438995, lng: 27.82180977 },
  // { lat: -26.30406952, lng: 27.8216095 },
  // { lat: -26.30405045, lng: 27.82002068 },
  // { lat: -26.30388069, lng: 27.81529045 },
  // { lat: -26.3033905, lng: 27.81528091 },
  // { lat: -26.30249023, lng: 27.81528091 },
  // { lat: -26.30228996, lng: 27.81526947 },
  // { lat: -26.3017292, lng: 27.8152504 },
  // { lat: -26.29944992, lng: 27.81524849 },
  // { lat: -26.29933548, lng: 27.81521988 },
  // { lat: -26.29455948, lng: 27.81517982 },
  // { lat: -26.29006004, lng: 27.81514931 },
  // { lat: -26.28692055, lng: 27.81513977 },
  // { lat: -26.2867794, lng: 27.81505585 },
  // { lat: -26.28572655, lng: 27.81504059 },
  // { lat: -26.28553963, lng: 27.81484032 },
  // { lat: -26.28499985, lng: 27.8146801 },
  // { lat: -26.28486061, lng: 27.81421089 },
  // { lat: -26.28473091, lng: 27.81380081 },
  // { lat: -26.28476906, lng: 27.81377029 },
  // { lat: -26.28498077, lng: 27.81368065 },
  // { lat: -26.28565025, lng: 27.80956841 },
  // { lat: -26.28600311, lng: 27.80912971 },
  // { lat: -26.28603935, lng: 27.8084507 },
  // { lat: -26.28610039, lng: 27.80690002 },
  // { lat: -26.28623009, lng: 27.80324936 },
  // { lat: -26.28653908, lng: 27.8030262 },
  // { lat: -26.28656006, lng: 27.80278969 },
  // { lat: -26.28657913, lng: 27.79966927 },
  // { lat: -26.28684044, lng: 27.79520035 },
  // { lat: -26.28722, lng: 27.79229927 },
  // { lat: -26.28746986, lng: 27.78972054 },
  // { lat: -26.3039093, lng: 27.78280067 },
  // { lat: -26.3043499, lng: 27.78021812 },
  // { lat: -26.29654312, lng: 27.77651024 },
  // { lat: -26.28532982, lng: 27.7725296 },
  // { lat: -26.28556061, lng: 27.76350975 },
  // { lat: -26.28607941, lng: 27.74379921 },
  // { lat: -26.28722, lng: 27.74464989 },
  // { lat: -26.27948952, lng: 27.7505188 },
  // { lat: -26.26521492, lng: 27.75348091 },
  // { lat: -26.25803947, lng: 27.72915077 },
  // { lat: -26.24629021, lng: 27.72899055 },
  // { lat: -26.24526978, lng: 27.72853088 },
  // { lat: -26.24249077, lng: 27.72611046 },
  // { lat: -26.24019051, lng: 27.72644043 },
  // { lat: -26.24007034, lng: 27.72616005 },
  // { lat: -26.23978043, lng: 27.72579002 },
  // { lat: -26.23941994, lng: 27.72495079 },
  // { lat: -26.23870087, lng: 27.72468948 },
  // { lat: -26.23807907, lng: 27.72327042 },
  // { lat: -26.23480034, lng: 27.72236061 },
  // { lat: -26.23267937, lng: 27.72064972 },
  // { lat: -26.22871971, lng: 27.71875 },
  // { lat: -26.22429085, lng: 27.71776199 },
  // { lat: -26.22198868, lng: 27.71479034 },
  // { lat: -26.21507072, lng: 27.71426964 },
  // { lat: -26.21386909, lng: 27.71570015 },
  // { lat: -26.21430016, lng: 27.71850967 },
  // { lat: -26.21389008, lng: 27.7195797 },
  // { lat: -26.21067047, lng: 27.71928024 },
  // { lat: -26.21058083, lng: 27.71951866 },
  // { lat: -26.20899391, lng: 27.71953011 },
  // { lat: -26.2089138, lng: 27.71956062 },
  // { lat: -26.20871925, lng: 27.72013092 },
  // { lat: -26.20495033, lng: 27.72028923 },
  // { lat: -26.20385933, lng: 27.71776009 },
  // { lat: -26.20285606, lng: 27.71826935 },
  // { lat: -26.19893074, lng: 27.74568939 },
  // { lat: -26.20621872, lng: 27.74952126 },
  // { lat: -26.20723724, lng: 27.77198982 },
  // { lat: -26.21320915, lng: 27.77449036 },
  // { lat: -26.20768929, lng: 27.77660942 },
  // { lat: -26.20301247, lng: 27.77666473 },
  // { lat: -26.20288849, lng: 27.7773037 },
  // { lat: -26.20147705, lng: 27.77968407 },
  // { lat: -26.1962204, lng: 27.78133965 },
  // { lat: -26.19260025, lng: 27.7818718 },
  // { lat: -26.19142342, lng: 27.78211784 },
  // { lat: -26.19088173, lng: 27.78239059 },
  // { lat: -26.19028091, lng: 27.78457069 },
  // { lat: -26.18548012, lng: 27.78536987 },
  // { lat: -26.18367004, lng: 27.78570557 },
  // { lat: -26.18292236, lng: 27.78609657 },
  // { lat: -26.1820488, lng: 27.78612518 },
  // { lat: -26.18198204, lng: 27.78614044 },
  // { lat: -26.18194962, lng: 27.78944969 },
  // { lat: -26.18198013, lng: 27.7925148 },
  // { lat: -26.18198013, lng: 27.79366493 },
  // { lat: -26.18198013, lng: 27.79477882 },
  // { lat: -26.18198776, lng: 27.79513931 },
  // { lat: -26.18198967, lng: 27.79970932 },
  // { lat: -26.1819706, lng: 27.80591583 },
  // { lat: -26.18203354, lng: 27.81060028 },
  // { lat: -26.18207932, lng: 27.81059074 },
  // { lat: -26.18203545, lng: 27.81056023 },
  // { lat: -26.18190956, lng: 27.80908966 },
  // { lat: -26.17519379, lng: 27.80905914 },
  // { lat: -26.17506027, lng: 27.81200981 },
  // { lat: -26.17588997, lng: 27.81352043 },
  // { lat: -26.17605972, lng: 27.81804657 },
  // { lat: -26.17596054, lng: 27.81852913 },
  // { lat: -26.17501068, lng: 27.81856918 },
  // { lat: -26.17501068, lng: 27.81860924 },
  // { lat: -26.1749897, lng: 27.81866074 },
  // { lat: -26.17498016, lng: 27.81871986 },
  // { lat: -26.17497063, lng: 27.81875992 },
  // { lat: -26.17495918, lng: 27.81883049 },
  // { lat: -26.17493057, lng: 27.81893921 },
  // { lat: -26.17489433, lng: 27.81901932 },
  // { lat: -26.17481995, lng: 27.81905937 },
  // { lat: -26.17477036, lng: 27.81908989 },
  // { lat: -26.1747303, lng: 27.81912994 },
  // { lat: -26.17469025, lng: 27.81915092 },
  // { lat: -26.17465019, lng: 27.81917953 },
  // { lat: -26.17461014, lng: 27.81920052 },
  // { lat: -26.17457008, lng: 27.81922913 },
  // { lat: -26.17453003, lng: 27.81929016 },
  // { lat: -26.17443085, lng: 27.81930923 },
  // { lat: -26.17437935, lng: 27.81937027 },
  // { lat: -26.17429924, lng: 27.81940079 },
  // { lat: -26.17428017, lng: 27.81954956 },
  // { lat: -26.17436981, lng: 27.81945992 },
  // { lat: -26.17420006, lng: 27.8194809 },
  // { lat: -26.17416, lng: 27.81950951 },
  // { lat: -26.17411995, lng: 27.81953049 },
  // { lat: -26.17406082, lng: 27.8195591 },
  // { lat: -26.17400932, lng: 27.81958008 },
  // { lat: -26.1739502, lng: 27.8196907 },
  // { lat: -26.17373085, lng: 27.81970978 },
  // { lat: -26.17366028, lng: 27.8197403 },
  // { lat: -26.17358971, lng: 27.81975937 },
  // { lat: -26.17353058, lng: 27.81978035 },
  // { lat: -26.17341042, lng: 27.81978989 },
  // { lat: -26.17337036, lng: 27.81979561 },
  // { lat: -26.17329979, lng: 27.81978035 },
  // { lat: -26.17324066, lng: 27.81978035 },
  // { lat: -26.17316055, lng: 27.81977081 },
  // { lat: -26.17310905, lng: 27.81974983 },
  // { lat: -26.17304993, lng: 27.8197403 },
  // { lat: -26.1729908, lng: 27.81970024 },
  // { lat: -26.1729393, lng: 27.81966019 },
  // { lat: -26.17291069, lng: 27.81962967 },
  // { lat: -26.17288017, lng: 27.81958961 },
  // { lat: -26.17284966, lng: 27.81953049 },
  // { lat: -26.1728096, lng: 27.81949997 },
  // { lat: -26.17277908, lng: 27.81945038 },
  // { lat: -26.17276001, lng: 27.81941032 },
  // { lat: -26.17274094, lng: 27.81938934 },
  // { lat: -26.17271042, lng: 27.81936073 },
  // { lat: -26.17268944, lng: 27.81933975 },
  // { lat: -26.17267036, lng: 27.81933022 },
  // { lat: -26.17263031, lng: 27.81934929 },
  // { lat: -26.17258072, lng: 27.81936073 },
  // { lat: -26.17254066, lng: 27.81936073 },
  // { lat: -26.17251015, lng: 27.81937027 },
  // { lat: -26.17247963, lng: 27.81937027 },
  // { lat: -26.17206001, lng: 27.81934929 },
  // { lat: -26.17204094, lng: 27.81933022 },
  // { lat: -26.17200089, lng: 27.81933022 },
  // { lat: -26.17190933, lng: 27.81932068 },
  // { lat: -26.17188072, lng: 27.8192749 },
  // { lat: -26.17181015, lng: 27.81926918 },
  // { lat: -26.1717701, lng: 27.81925011 },
  // { lat: -26.17174911, lng: 27.81921959 },
  // { lat: -26.17168999, lng: 27.81920433 },
  // { lat: -26.17164993, lng: 27.81917953 },
  // { lat: -26.17161942, lng: 27.81916046 },
  // { lat: -26.17157936, lng: 27.81913948 },
  // { lat: -26.17156029, lng: 27.81909943 },
  // { lat: -26.17147064, lng: 27.81909943 },
  // { lat: -26.17144012, lng: 27.81908035 },
  // { lat: -26.17140961, lng: 27.81904984 },
  // { lat: -26.17134094, lng: 27.81903076 },
  // { lat: -26.17130089, lng: 27.81901932 },
  // { lat: -26.17127037, lng: 27.81899071 },
  // { lat: -26.17120934, lng: 27.81896973 },
  // { lat: -26.17119026, lng: 27.81896019 },
  // { lat: -26.17115021, lng: 27.81892967 },
  // { lat: -26.17107964, lng: 27.81889915 },
  // { lat: -26.17103004, lng: 27.81888962 },
  // { lat: -26.17098999, lng: 27.81888008 },
  // { lat: -26.17095947, lng: 27.81888008 },
  // { lat: -26.17093086, lng: 27.8188591 },
  // { lat: -26.17090988, lng: 27.81884003 },
  // { lat: -26.17087936, lng: 27.81881905 },
  // { lat: -26.17085075, lng: 27.81879997 },
  // { lat: -26.17082977, lng: 27.81879044 },
  // { lat: -26.17079926, lng: 27.81871986 },
  // { lat: -26.17073059, lng: 27.81870079 },
  // { lat: -26.17069054, lng: 27.81867409 },
  // { lat: -26.17065048, lng: 27.81864548 },
  // { lat: -26.17061043, lng: 27.81860924 },
  // { lat: -26.17057037, lng: 27.81859016 },
  // { lat: -26.17053986, lng: 27.81856918 },
  // { lat: -26.1704998, lng: 27.81854439 },
  // { lat: -26.17048073, lng: 27.81851959 },
  // { lat: -26.17045021, lng: 27.8184948 },
  // { lat: -26.17041016, lng: 27.81847 },
  // { lat: -26.17037964, lng: 27.81842995 },
  // { lat: -26.17029953, lng: 27.81840515 },
  // { lat: -26.17025948, lng: 27.81838417 },
  // { lat: -26.17020988, lng: 27.81834984 },
  // { lat: -26.17016411, lng: 27.81831932 },
  // { lat: -26.17012978, lng: 27.81830025 },
  // { lat: -26.17008972, lng: 27.81827927 },
  // { lat: -26.17007065, lng: 27.81824493 },
  // { lat: -26.17004013, lng: 27.81821442 },
  // { lat: -26.17, lng: 27.81814957 },
  // { lat: -26.1699295, lng: 27.81810951 },
  // { lat: -26.16991425, lng: 27.8180809 },
  // { lat: -26.16988945, lng: 27.81805992 },
  // { lat: -26.16987038, lng: 27.81802559 },
  // { lat: -26.16983986, lng: 27.81800079 },
  // { lat: -26.16982079, lng: 27.81797981 },
  // { lat: -26.16979408, lng: 27.8179493 },
  // { lat: -26.16976929, lng: 27.81786919 },
  // { lat: -26.16972923, lng: 27.81785011 },
  // { lat: -26.16970444, lng: 27.81780434 },
  // { lat: -26.16967964, lng: 27.81777954 },
  // { lat: -26.16966057, lng: 27.81776047 },
  // { lat: -26.16963005, lng: 27.81769943 },
  // { lat: -26.16959953, lng: 27.81765938 },
  // { lat: -26.1695652, lng: 27.81761932 },
  // { lat: -26.16954041, lng: 27.81759071 },
  // { lat: -26.16953087, lng: 27.81748962 },
  // { lat: -26.16947937, lng: 27.81745911 },
  // { lat: -26.16946983, lng: 27.81740952 },
  // { lat: -26.16945076, lng: 27.81731987 },
  // { lat: -26.16941071, lng: 27.81726074 },
  // { lat: -26.16937447, lng: 27.81722069 },
  // { lat: -26.16935921, lng: 27.81710052 },
  // { lat: -26.1692791, lng: 27.81706429 },
  // { lat: -26.16926956, lng: 27.81702042 },
  // { lat: -26.16924095, lng: 27.8169899 },
  // { lat: -26.16921043, lng: 27.81694984 },
  // { lat: -26.16918564, lng: 27.81693077 },
  // { lat: -26.16916084, lng: 27.81689072 },
  // { lat: -26.16912079, lng: 27.81682968 },
  // { lat: -26.16909027, lng: 27.81679916 },
  // { lat: -26.16905022, lng: 27.81678009 },
  // { lat: -26.16902924, lng: 27.81674957 },
  // { lat: -26.16901016, lng: 27.81669998 },
  // { lat: -26.16896439, lng: 27.81666946 },
  // { lat: -26.16893959, lng: 27.81664085 },
  // { lat: -26.16893005, lng: 27.8166008 },
  // { lat: -26.16889, lng: 27.81656075 },
  // { lat: -26.1688652, lng: 27.81652069 },
  // { lat: -26.16883469, lng: 27.8164196 },
  // { lat: -26.16873932, lng: 27.81637955 },
  // { lat: -26.16872025, lng: 27.81633949 },
  // { lat: -26.16870499, lng: 27.81631088 },
  // { lat: -26.16868019, lng: 27.81620026 },
  // { lat: -26.16860008, lng: 27.8161602 },
  // { lat: -26.16859055, lng: 27.81611061 },
  // { lat: -26.16853905, lng: 27.81605911 },
  // { lat: -26.1685257, lng: 27.81600952 },
  // { lat: -26.16847992, lng: 27.81598091 },
  // { lat: -26.16846085, lng: 27.81593513 },
  // { lat: -26.16843033, lng: 27.8159008 },
  // { lat: -26.16840935, lng: 27.81587029 },
  // { lat: -26.16839027, lng: 27.81583977 },
  // { lat: -26.16835976, lng: 27.81580925 },
  // { lat: -26.16834068, lng: 27.8157692 },
  // { lat: -26.1683197, lng: 27.81572914 },
  // { lat: -26.16827965, lng: 27.81570435 },
  // { lat: -26.16826057, lng: 27.81565094 },
  // { lat: -26.16823006, lng: 27.81562042 },
  // { lat: -26.16822052, lng: 27.81555939 },
  // { lat: -26.16819, lng: 27.81542969 },
  // { lat: -26.16814423, lng: 27.8153801 },
  // { lat: -26.16813087, lng: 27.81531906 },
  // { lat: -26.16813087, lng: 27.81528091 },
  // { lat: -26.16810989, lng: 27.81513023 },
  // { lat: -26.16810989, lng: 27.81509972 },
  // { lat: -26.16810036, lng: 27.81505966 },
  // { lat: -26.16810989, lng: 27.81501007 },
  // { lat: -26.16811943, lng: 27.81497955 },
  // { lat: -26.16813087, lng: 27.8149395 },
  // { lat: -26.16814041, lng: 27.81488037 },
  // { lat: -26.16815948, lng: 27.81484032 },
  // { lat: -26.16816521, lng: 27.81479073 },
  // { lat: -26.16818047, lng: 27.81475067 },
  // { lat: -26.16819, lng: 27.81469917 },
  // { lat: -26.16820908, lng: 27.81464958 },
  // { lat: -26.16822052, lng: 27.81451035 },
  // { lat: -26.16823006, lng: 27.81446075 },
  // { lat: -26.16820908, lng: 27.8144207 },
  // { lat: -26.16819954, lng: 27.8143692 },
  // { lat: -26.16818047, lng: 27.81428909 },
  // { lat: -26.16815948, lng: 27.81426048 },
  // { lat: -26.16814995, lng: 27.81422997 },
  // { lat: -26.16814041, lng: 27.81419945 },
  // { lat: -26.16811943, lng: 27.81415939 },
  // { lat: -26.16810036, lng: 27.81414032 },
  // { lat: -26.16807938, lng: 27.81410027 },
  // { lat: -26.16806984, lng: 27.81406021 },
  // { lat: -26.16804504, lng: 27.81401062 },
  // { lat: -26.16801071, lng: 27.81398964 },
  // { lat: -26.16798973, lng: 27.81395912 },
  // { lat: -26.16798019, lng: 27.81389046 },
  // { lat: -26.16794014, lng: 27.81385994 },
  // { lat: -26.16791916, lng: 27.81381989 },
  // { lat: -26.16790009, lng: 27.81378937 },
  // { lat: -26.1678791, lng: 27.81374931 },
  // { lat: -26.16784096, lng: 27.81370926 },
  // { lat: -26.16782951, lng: 27.81368065 },
  // { lat: -26.16781044, lng: 27.81362915 },
  // { lat: -26.16778946, lng: 27.81360054 },
  // { lat: -26.16777992, lng: 27.81357956 },
  // { lat: -26.16776085, lng: 27.81352043 },
  // { lat: -26.16773033, lng: 27.81348991 },
  // { lat: -26.16772079, lng: 27.81343079 },
  // { lat: -26.16769028, lng: 27.81339073 },
  // { lat: -26.16766548, lng: 27.81335068 },
  // { lat: -26.16765022, lng: 27.8133297 },
  // { lat: -26.16762924, lng: 27.81325912 },
  // { lat: -26.16758537, lng: 27.81320953 },
  // { lat: -26.16756058, lng: 27.81318092 },
  // { lat: -26.16754913, lng: 27.81310081 },
  // { lat: -26.16753006, lng: 27.81306076 },
  // { lat: -26.16749954, lng: 27.81299019 },
  // { lat: -26.16747475, lng: 27.8129406 },
  // { lat: -26.16745567, lng: 27.81291008 },
  // { lat: -26.16743088, lng: 27.81287956 },
  // { lat: -26.16743088, lng: 27.81286049 },
  // { lat: -26.1674099, lng: 27.81282043 },
  // { lat: -26.16740417, lng: 27.81278038 },
  // { lat: -26.16739082, lng: 27.81274033 },
  // { lat: -26.16736412, lng: 27.81270027 },
  // { lat: -26.16733932, lng: 27.81267929 },
  // { lat: -26.16732025, lng: 27.81265068 },
  // { lat: -26.16732025, lng: 27.8126297 },
  // { lat: -26.16729927, lng: 27.81259918 },
  // { lat: -26.1672802, lng: 27.81258011 },
  // { lat: -26.16725922, lng: 27.81254959 },
  // { lat: -26.16724968, lng: 27.81251907 },
  // { lat: -26.16722488, lng: 27.81248093 },
  // { lat: -26.16720009, lng: 27.81245041 },
  // { lat: -26.16717529, lng: 27.81241035 },
  // { lat: -26.16713524, lng: 27.81236076 },
  // { lat: -26.16708946, lng: 27.81233025 },
  // { lat: -26.16705513, lng: 27.81229973 },
  // { lat: -26.16703033, lng: 27.81228065 },
  // { lat: -26.16699982, lng: 27.81226921 },
  // { lat: -26.1669693, lng: 27.81224442 },
  // { lat: -26.16695023, lng: 27.81233978 },
  // { lat: -26.16688919, lng: 27.81303978 },
  // { lat: -26.16655922, lng: 27.81397057 },
  // { lat: -26.16489029, lng: 27.81811714 },
  // { lat: -26.15749168, lng: 27.81813431 },
  // { lat: -26.15745926, lng: 27.81825066 },
  // { lat: -26.15725327, lng: 27.82116508 },
  // { lat: -26.15205383, lng: 27.82256889 },
  // { lat: -26.14955139, lng: 27.82571983 },
  // { lat: -26.14393044, lng: 27.83311653 },
  // { lat: -26.13072205, lng: 27.83456993 },
  // { lat: -26.12812805, lng: 27.83461189 },
  // { lat: -26.12805176, lng: 27.83468056 },
  // { lat: -26.12792969, lng: 27.83574486 },
  // { lat: -26.12603188, lng: 27.83592224 },
  // { lat: -26.12586403, lng: 27.83737946 },
  // { lat: -26.12449074, lng: 27.83724022 },
  // { lat: -26.1243, lng: 27.83880997 },
  // { lat: -26.12022018, lng: 27.83786011 },
  // { lat: -26.11990929, lng: 27.83858871 },
  // { lat: -26.11795235, lng: 27.83870506 },
  // { lat: -26.11763763, lng: 27.8390007 },
  // { lat: -26.1168499, lng: 27.83217049 },
  // { lat: -26.11455917, lng: 27.83189011 },
  // { lat: -26.11364937, lng: 27.83204079 },
  // { lat: -26.11273956, lng: 27.83262062 },
  // { lat: -26.11137009, lng: 27.83229065 },
  // { lat: -26.11084938, lng: 27.83222961 },
  // { lat: -26.11078072, lng: 27.83218002 },
  // { lat: -26.11070061, lng: 27.83209991 },
  // { lat: -26.11058998, lng: 27.83205032 },
  // { lat: -26.11046982, lng: 27.83198929 },
  // { lat: -26.11030006, lng: 27.8319397 },
  // { lat: -26.11017036, lng: 27.83188057 },
  // { lat: -26.11004066, lng: 27.83184052 },
  // { lat: -26.10993004, lng: 27.83188057 },
  // { lat: -26.10980034, lng: 27.83196068 },
  // { lat: -26.10972977, lng: 27.83200073 },
  // { lat: -26.10965919, lng: 27.83201027 },
  // { lat: -26.10956001, lng: 27.83204079 },
  // { lat: -26.1092701, lng: 27.83204079 },
  // { lat: -26.10913086, lng: 27.83205032 },
  // { lat: -26.10899925, lng: 27.83205032 },
  // { lat: -26.10884094, lng: 27.83202934 },
  // { lat: -26.10873032, lng: 27.83202934 },
  // { lat: -26.10862923, lng: 27.83205986 },
  // { lat: -26.10856056, lng: 27.83214951 },
  // { lat: -26.10853958, lng: 27.83226013 },
  // { lat: -26.10853004, lng: 27.83234978 },
  // { lat: -26.10848999, lng: 27.83251953 },
  // { lat: -26.1084404, lng: 27.83271027 },
  // { lat: -26.10836983, lng: 27.8328495 },
  // { lat: -26.10827065, lng: 27.83300972 },
  // { lat: -26.10816002, lng: 27.83312035 },
  // { lat: -26.10808945, lng: 27.83319092 },
  // { lat: -26.10806084, lng: 27.83325958 },
  // { lat: -26.10798073, lng: 27.83333969 },
  // { lat: -26.10788918, lng: 27.83345985 },
  // { lat: -26.10780907, lng: 27.83357048 },
  // { lat: -26.10777092, lng: 27.83361053 },
  // { lat: -26.10774994, lng: 27.83378029 },
  // { lat: -26.10762978, lng: 27.83390045 },
  // { lat: -26.10754013, lng: 27.83396912 },
  // { lat: -26.10750961, lng: 27.83406067 },
  // { lat: -26.1074295, lng: 27.83410072 },
  // { lat: -26.10738945, lng: 27.83415985 },
  // { lat: -26.10733986, lng: 27.83422089 },
  // { lat: -26.10725975, lng: 27.83431053 },
  // { lat: -26.1072197, lng: 27.8343792 },
  // { lat: -26.10718918, lng: 27.8345108 },
  // { lat: -26.10714912, lng: 27.83459091 },
  // { lat: -26.10710907, lng: 27.83468056 },
  // { lat: -26.10707092, lng: 27.83477974 },
  // { lat: -26.10705948, lng: 27.83485031 },
  // { lat: -26.10701942, lng: 27.83499908 },
  // { lat: -26.10692024, lng: 27.83518982 },
  // { lat: -26.10681915, lng: 27.83527946 },
  // { lat: -26.10680008, lng: 27.83542061 },
  // { lat: -26.10680962, lng: 27.83580017 },
  // { lat: -26.10692024, lng: 27.83588028 },
  // { lat: -26.10692024, lng: 27.83596039 },
  // { lat: -26.10692978, lng: 27.83613014 },
  // { lat: -26.10702515, lng: 27.83617973 },
  // { lat: -26.10704994, lng: 27.83622932 },
  // { lat: -26.10705948, lng: 27.83626938 },
  // { lat: -26.10708046, lng: 27.83630943 },
  // { lat: -26.10710907, lng: 27.83638954 },
  // { lat: -26.10716057, lng: 27.83647919 },
  // { lat: -26.10720062, lng: 27.83667946 },
  // { lat: -26.10725975, lng: 27.83690071 },
  // { lat: -26.10737038, lng: 27.83699036 },
  // { lat: -26.10740089, lng: 27.83711052 },
  // { lat: -26.1074295, lng: 27.8372097 },
];

var Brixton = new google.maps.LatLng(-26.19391, 28.00146);

let map = new google.maps.Map(document.getElementById('map') as HTMLInputElement, {
  center: Brixton,
  zoom: 13,
  mapTypeId: 'satellite'
}); 

var heatmap = new google.maps.visualization.HeatmapLayer({
  data: CityofJoburgDelimiters
});
heatmap.setMap(map);

//Fusion chart
const dataSource = {
  chart: {
    caption: "Crime Stats",
    subCaption: "",
    xAxisName: "Province",
    yAxisName: "",
    numberSuffix: "K",
    theme: "fusion",
  },
  data: [
    { label: "Eastern Cape", value: "168" },
    { label: "Free State", value: "90" },
    { label: "Gauteng", value: "460" },
    { label: "KwaZulu Natal", value: "254" },
    { label: "Limpopo", value: "93" },
    { label: "Mpumalanga", value: "99" },
    { label: "North West", value: "44" },
    { label: "Western Cape", value: "322" },
  ],
};

const chartConfigs = {
  type: "column2d",
  width: 320,
  height: 580,
  dataFormat: "json",
  dataSource: dataSource,
};

// Map
const Statistic: React.FC = () => {
  const [page, setPage] = useState(2);
  // crime stats
  const [crimeStats, setCrimeStats] = useState({});
  const [position, setPosition] = useState({ latitude: 0, longitude: 0 });

  useEffect(() => {
    getLocation();
    getCrimeStats();
  }, []);

  // get crime stats
  const getCrimeStats = async () => {
    try {
      const { data, error } = await Supa.from("CrimeStats").select("*");

      if (error) console.log(error.message);
      else if (data) console.log(data);
    } catch (error: any) {
      console.log(error.message);
    }
  };

  //crimeStats coordinates

  //   const getCoordinates = async () => {
  //   // let coordinates;
  //   // let newMap;
  //   // const key = "AIzaSyC6d-uHz50G0AYmv3Ikio5G8SWKw_8ICiA";
  //   // const mapRef = useRef(null);

  //   try {
  //     const { data, error } = await Supa
  //     .from("CrimeStats").select("HeatMapLat" && "HeatMapLng");  
  //     if (error) console.log(error.message);
  //     else if (data) console.log(data)
      
  //       setItem({
  //         coords : location.map(function (d, index))
  //       coordinates: data.forEach((location) => {
  //         CityofJoburgDelimiters = [{
  //           lat: HeatMapLat,
  //           lng: HeatMapLng }]
  //     })
      
  //   } catch (error: any) {
  //     console.log(error.message);
  //   }
  // };

  // geocode crime stats
  const getLocation = async () => {
    await Geolocation.checkPermissions()
      .then(() => Geolocation.getCurrentPosition())
      .then((val: any) => {
        setPosition({
          latitude: val.coords.latitude,
          longitude: val.coords.longitude,
        });
      });
  };

  const user = supabase.auth.user();

  const { isLoaded } = useLoadScript({
    googleMapsApiKey: process.env.REACT_APP_GOOGLE_MAPS_API_KEY as string,
  });

  return (
    <IonPage>
      <IonHeader>
        <IonToolbar>
          <IonTitle>Statistics</IonTitle>
          <IonButtons slot="start">
            <IonMenuButton></IonMenuButton>
          </IonButtons>
          <IonButtons slot="end">
            <IonButton
              onClick={() => {
                page === 1 && setPage(2);
                page === 2 && setPage(1);
              }}
              expand="block"
            >
              {page === 1 && "Statistics"}
              {page === 2 && "Hotspots"}
            </IonButton>
          </IonButtons>
        </IonToolbar>
      </IonHeader>
      <IonContent>
        <div className="Map">
          {page === 1 && isLoaded && (
            <GoogleMap
              zoom={10}
              center={{
                lat: position.latitude,
                lng: position.longitude,
              }}
              mapContainerClassName="map-container"
              
            >
              <Marker
                position={{
                  lat: position.latitude,
                  lng: position.longitude,
                }}
              />
                  {/* {<HeatmapLayer
                    fitBoundsOnLoad
                    fitBoundsOnUpdate
                    points={CityofJoburgDelimiters}
                    longitudeExtractor={(m: any[]) => m[1]}
                    latitudeExtractor={(m: any[]) => m[0]}
                    intensityExtractor={(m: any[]) => parseFloat(m[2])}
              /> } */}

              {/* <script>
              var = BrixtonLatLng = [
                new google.maps.LatLng(-26,19391,28,00146)
              ];

              pointArray = new google.maps.MVCArray(BrixtonLatLng)

              heatmap = new google.maps.visualization.HeatmapLayer({
              data: pointArray
              {"}"});
              heatmap.setMap(map);
              </script> */}

                {/* <Polygon
                 paths={CityofJoburgDelimiters}
                 editable={false}
                 options={{
                  strokeColor: "#FF0000",
                  strokeOpacity: 0.4,
                  strokeWeight: 2,
                   fillColor: "red",
                  fillOpacity: 0.35,
                 }}
                />  */}
            </GoogleMap>
          )}

          {page === 2 && <ReactFC {...chartConfigs} />}
        </div>
      </IonContent>
    </IonPage>
  );
};




export default Statistic;
